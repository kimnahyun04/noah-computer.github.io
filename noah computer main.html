<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Noah's Mail Quest</title>
  <style>

    @font-face {
  font-family: 'DungGeunMo';
  src: url('./assets/fonts/DungGeunMo.ttf') format('truetype');
  font-display: swap;
}

    html, body {
      margin: 0;
      height: 100%;
      background: #0b0f1a;
      overflow: hidden;
    }

    .stage {
      position: relative;
      width: 100vw;
      height: 100vh;
    }

    .back-button {
      position: fixed;
      top: 1vh;
      left: 1vw;
      font-family: 'DungGeunMo', sans-serif;
      font-size: 1.8vh;
      padding: 0.6vh 1.2vw;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: 2px solid white;
      border-radius: 10px;
      text-decoration: none;
      z-index: 9999;
      backdrop-filter: blur(4px);
      transition: all 0.2s ease;
    }

    .back-button:hover {
      background: white;
      color: black;
      border-color: #0b0f1a;
    }

    .icon {
      position: absolute;
      width: 7vw;
      height: auto;
      image-rendering: pixelated;
      cursor: pointer;
      transition: transform 0.2s ease, filter 0.2s ease;
      filter: drop-shadow(-0.4vw -0.4vh 0 #131313);
      z-index: 5;
    }

    .icon:hover {
      transform: scale(1.1);
      filter: drop-shadow(0 0 0.6vw rgba(255, 255, 255, 0.9));
    }

    /* ê° ì•„ì´ì½˜ ìœ„ì¹˜ */
    .internet { top: 6.94vh; left: 6vw; }
    .mail { top: 20vh; left: 6vw; }
    .folder { top: 32.5vh; left: 6vw; }
    .trash { top: 45.8vh; left: 6vw; }
    .game { top: 59vh; left: 5vw; width: 9vw; }
    .music-icon { top: 73vh; left: 6vw; }

    .background {
      width: 100vw;
      height: 100vh;
      object-fit: contain;
      image-rendering: pixelated;
      z-index: 1;
      position: absolute;
    }

    .eye-wrapper {
      position: absolute;
      width: 100vw;
      top: -1vh;
      left: 0.003vw;
      z-index: 2;
      pointer-events: none;
    }

    .eye {
      width: 100%;
      height: auto;
      image-rendering: pixelated;
      transition: transform 0.05s linear;
    }

    /* ë°°ì§€ ìŠ¤íƒ€ì¼ */
    .badge {
      position: absolute;
      min-width: 1.8vw;
      height: 1.8vw;
      border-radius: 50%;
      background: red;
      color: white;
      font-size: 1vw;
      font-weight: bold;
      text-align: center;
      line-height: 1.8vw;
      display: none;
      border: 2px solid white;
      z-index: 10;
      pointer-events: none;
    }

    /* ë©”ì„¸ì§€ì°½ */
    #messageContainer {
      position: absolute;
      top: 10vh;
      right: 5vw;
      width: 30vw;
      display: none;
      box-shadow: 10px 10px 0px rgba(0,0,0,0.95);
      border: 2px solid #000;
      z-index: 20;
    }
    #messageWindow {
      width: 100%;
      height: auto;
      image-rendering: pixelated;
    }

    #closeBtn {
      position: absolute;
      top: 1vh;
      right: 0.5vw;
      width: 3vw;
      height: 3vh;
      cursor: pointer;
      z-index: 300;
      background: transparent;
    }

    #illegalMsg {
      position: absolute;
      top: -6vh;
      left: -5.6vw;
      width: 40vw;
      display: none;
      image-rendering: pixelated;
      z-index: 25;
      cursor: pointer;
    }

    /* ë“œë˜ê·¸ ì˜ì—­ */
    #messageHeader {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3vh;
      cursor: move;
      z-index: 30;
    }

    #messageContainer img {
      -webkit-user-drag: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      pointer-events: auto;
    }

    /* ìë§‰ ìŠ¤íƒ€ì¼ */
    #subtitle {
      position: fixed;
      bottom: 5vh;
      left: 50%;
      transform: translateX(-50%);
      font-family: 'DungGeunMo', sans-serif;
      color: white;
      background: rgba(0, 0, 0, 0.6);
      border: 2px solid white;
      border-radius: 10px;
      padding: 1vh 2vw;
      font-size: 2.2vh;
      text-align: center;
      z-index: 999;
      display: none;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .next-indicator {
  font-size: 1.8vh;
  color: #ffcc00;
  margin-left: 1vw;
  animation: blink 1s infinite alternate;
}

@keyframes blink {
  from { opacity: 0.3; }
  to { opacity: 1; }
}

  </style>
</head>
<body>
  <a href="./play.html" class="back-button">â† ë’¤ë¡œê°€ê¸°</a>

  <div class="stage">
    <img class="background" src="./ì›¹ë””ë°°ê²½.gif" alt="ë°°ê²½ ì´ë¯¸ì§€" />

    <img class="icon internet" src="./ì¸í„°ë„· ë¡œê³ .png" alt="ì¸í„°ë„·" />
    <img class="icon mail" src="./ë©”ì„¸ì§€ ì•„ì´ì½˜.png" alt="ë©”ì¼" />
    <img class="icon folder" src="./í´ë” ì•„ì´ì½˜.png" alt="í´ë”" />
    <img class="icon trash" src="./ì“°ë ˆê¸°í†µ.png" alt="íœ´ì§€í†µ" />
    <img class="icon game" src="./ë¶ˆë²•ê²Œì„ ì•„ì´ì½˜.png" alt="ê²Œì„" />
    <img class="icon music-icon" src="./ìŒì•…ì•„ì´ì½˜.png" alt="ìŒì•…" />

    <audio id="bgMusic" src="./ccbd0760-d720-4ca1-974a-c02f098588c5.mp3" preload="auto"></audio>

    <div class="eye-wrapper" id="eyeWrapper">
      <img class="eye" id="eye" src="./ëˆˆì•Œ.png" alt="ì›€ì§ì´ëŠ” ëˆˆì•Œ" />
    </div>

  </div>

 <span id="badge" class="badge">1</span>
  <div id="subtitle"></div>

  <div id="messageContainer">
    <div id="messageHeader"></div>
    <img id="messageWindow" src="./ë©”ì„¸ì§€-ì°½.png" alt="ë©”ì„¸ì§€ ì°½" />
    <img id="illegalMsg" src="./ë©”ì„¸ì§€-ë§.png" alt="ë¶ˆë²•ë©”ì„¸ì§€" />
    <div id="closeBtn"></div>
  </div>
 <audio id="nextSound" src="./ë‹¤ìŒ í´ë¦­.mp3" preload="auto"></audio>

  <script>
  // ===== ëˆˆ ì›€ì§ì„ =====
  const eye = document.getElementById("eye");
  const eyeWrapper = document.getElementById("eyeWrapper");

  function updateEyePosition(e) {
    const rect = eyeWrapper.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;
    const dx = e.clientX - centerX;
    const dy = e.clientY - centerY;
    const maxMove = rect.width * 0.005;
    const moveX = Math.max(Math.min(dx / 20, maxMove), -maxMove);
    const moveY = Math.max(Math.min(dy / 20, maxMove), -maxMove);
    eye.style.transform = `translate(${moveX}px, ${moveY}px)`;
  }

  window.addEventListener("mousemove", updateEyePosition);
  window.addEventListener("resize", () => {
    eye.style.transform = "translate(0, 0)";
  });

  // ===== ë°°ê²½ìŒì•… =====
  const musicIcon = document.querySelector(".icon.music-icon");
  const bgm = document.getElementById("bgMusic");
  let isPlaying = false;
  musicIcon.addEventListener("click", () => {
    if (!isPlaying) {
      bgm.play();
      isPlaying = true;
    } else {
      bgm.pause();
      isPlaying = false;
    }
  });

  // ===== ë°°ì§€ (ë©”ì¼ ì•„ì´ì½˜) =====
  const badge = document.getElementById("badge");
  const mailIcon = document.querySelector(".icon.mail");

  function showBadgeOnMail() {
    const rect = mailIcon.getBoundingClientRect();
    const stageRect = document.querySelector(".stage").getBoundingClientRect();
    const leftVW = ((rect.left - stageRect.left + rect.width) / window.innerWidth) * 100;
    const topVH = ((rect.top - stageRect.top) / window.innerHeight) * 100;
    badge.style.left = (leftVW - 2) + "vw";
    badge.style.top = topVH + "vh";
    badge.style.display = "block";
  }

  // ===== ìë§‰ ë¡œì§ ("ë‹¤ìŒ â–¶" í¬í•¨) =====
  const subtitle = document.getElementById("subtitle");

  const subtitles = [
    "ë‚˜ì—ê²Œë„ ìƒˆ ì»´í“¨í„°ê°€...",
    "ë­ í•  ê±° ì—†ë‚˜...",
    "ë¬¸ìê°€ ì™”ë„¤, ëˆ„êµ¬ì§€?"
  ];

  let subtitleStep = 0;

  function showSubtitle(text, showNext = true) {
    subtitle.innerHTML = showNext
      ? `${text}<span class="next-indicator">ë‹¤ìŒ â–¶</span>`
      : text;
    subtitle.style.display = "block";
  }

  const nextSound = document.getElementById("nextSound");

subtitle.addEventListener("click", () => {
  // ğŸ”Š ì‚¬ìš´ë“œ ì¬ìƒ
  nextSound.currentTime = 0;
  nextSound.play();

  subtitleStep++;
  if (subtitleStep < subtitles.length) {
    showSubtitle(subtitles[subtitleStep]);
  } else {
    subtitle.style.display = "none";
    showBadgeOnMail();
  }
});


  // ===== íƒ€ì´ë° ìˆœì„œ =====
  window.addEventListener("load", () => {
    setTimeout(() => {
      showSubtitle(subtitles[0]); // ì²« ìë§‰ í‘œì‹œ (3ì´ˆ í›„)
    }, 3000);

  // ğŸ’Œ 7ì´ˆ ë’¤ ìë™ìœ¼ë¡œ ë°°ì§€ ë„ìš°ê¸°
  setTimeout(() => {
    showBadgeOnMail();
  }, 6000);
});


  // ===== ë©”ì„¸ì§€ì°½ =====
  const messageContainer = document.getElementById("messageContainer");
  const illegalMsg = document.getElementById("illegalMsg");
  const closeBtn = document.getElementById("closeBtn");

  // ë©”ì„¸ì§€ ì•„ì´ì½˜ í´ë¦­ â†’ ì°½ ì—´ê¸° + í—¨ë¦¬ ëŒ€ì‚¬ ì¶œë ¥
  mailIcon.addEventListener("click", () => {
    messageContainer.style.display = "block";
    badge.style.display = "none";

    setTimeout(() => {
      illegalMsg.style.display = "block";
      showSubtitle("ë­ì•¼, í—¨ë¦¬ì–ì•„?", false);
      setTimeout(() => {
        showSubtitle("ì´ ë§í¬ëŠ” ë­ì§€? í´ë¦­í•´ ë´ì•¼ê² ë‹¤.", false);
      }, 2500);
    }, 1000);
  });

  // ë§í’ì„  í´ë¦­ â†’ ê°ì—¼ í™”ë©´ ì´ë™
  illegalMsg.addEventListener("click", () => {
    window.location.href = "mail virus.html";
  });

  // X ë²„íŠ¼ í´ë¦­ â†’ ì°½ ë‹«ê¸°
  closeBtn.addEventListener("click", () => {
    messageContainer.style.display = "none";
  });

  // ===== ë“œë˜ê·¸ ë¡œì§ =====
  const header = document.getElementById("messageHeader");
  let offsetX = 0, offsetY = 0, isDragging = false;

  header.addEventListener("mousedown", (e) => {
    isDragging = true;
    offsetX = e.clientX - messageContainer.offsetLeft;
    offsetY = e.clientY - messageContainer.offsetTop;
  });

  document.addEventListener("mousemove", (e) => {
    if (isDragging) {
      messageContainer.style.left = (e.clientX - offsetX) + "px";
      messageContainer.style.top = (e.clientY - offsetY) + "px";
      messageContainer.style.right = "auto";
    }
  });

  document.addEventListener("mouseup", () => {
    isDragging = false;
  });
</script>












